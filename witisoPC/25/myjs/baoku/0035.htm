 
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0032)http://www.ie-zone.com/index.php -->
<HTML><!-- #BeginTemplate "/Templates/JsExample.dwt" --><HEAD>
<!-- #BeginEditable "doctitle" --> 
<TITLE>树型菜单</TITLE>
<!-- #EndEditable -->
<META http-equiv=Content-Type content="text/html; charset=gb2312"><LINK  href="../fav.ico" rel="shortcut icon">
<STYLE type=text/css>BODY {
	MARGIN: 25px 25px 25px
}
#all TD {
	FONT-SIZE: 12px; LINE-HEIGHT: 15px; FONT-FAMILY: "Verdana", "Arial","新宋体", "宋体"
}
INPUT {
	FONT-SIZE: 12px; LINE-HEIGHT: 15px; FONT-FAMILY: "Verdana", "Arial","新宋体", "宋体"
}
SELECT {
	FONT-SIZE: 12px; LINE-HEIGHT: 15px; FONT-FAMILY: "Verdana", "Arial","新宋体", "宋体"
}
P {
	FONT-SIZE: 12px; LINE-HEIGHT: 15px; FONT-FAMILY: "Verdana", "Arial","新宋体", "宋体"
}
TEXTAREA {
	FONT-SIZE: 12px; LINE-HEIGHT: 15px; FONT-FAMILY: "Verdana", "Arial","新宋体", "宋体"
}

#all A:active {
	COLOR: #7d070c
}
#all A:visited {
	COLOR: #7d070c
}

#all A:hover {
	COLOR: #336699
}
#all A:link {
	COLOR: #7d070c
}
</STYLE>

<SCRIPT language=JavaScript>
<!--
function MM_goToURL() { //v3.0
  var i, args=MM_goToURL.arguments; document.MM_returnValue = false;
  for (i=0; i<(args.length-1); i+=2) eval(args[i]+".location='"+args[i+1]+"'");
}
function JM_cc(ob){
ob.select();js=ob.createTextRange();js.execCommand("Copy");
}
//-->
</SCRIPT>

<META content="MSHTML 5.50.4134.600" name=GENERATOR></HEAD>
<BODY id=all text=#000000 bgColor=#336699>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TR bgColor=#ffffff> 
    <TD><IMG src="../images/sq_1.gif" width=11 height="14"></TD>
    <TD width="100%"></TD>
    <TD><IMG src="../images/sq_2.gif"    width=11 height="14"></TD>
  </TR>
</TABLE>
<!-- #BeginEditable "Example%20and%20Sources" --> 
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TR bgColor=#ffffff> 
    <TD><IMG src="../images/space.gif" width=11 height="1"></TD>
    <TD width="100%">
      <table width="100%" border="0" cellpadding="8">
        <tr> 
          <td align="center"><!-- #BeginLibraryItem "/Library/js_title.lbi" --><script language="JavaScript">
document.write("<font color=#7d070c style=\"font-size: 14px\">"+document.title+"</font>");
</script><!-- #EndLibraryItem --></td>
        </tr>
        <tr> 
          <td bgcolor="#f7f7f7"> 
            <style>
<!--
#foldheader{cursor:hand ; font-weight:bold ;
list-style-image:url(img/fold.gif)}
#foldinglist{list-style-image:url(img/list.gif)}
//-->
</style>
            <script language="JavaScript1.2">
<!--
/** 
 *  Based on Folding Menu Tree 
 *  Dynamic Drive (www.dynamicdrive.com)
 *  For full source code, installation instructions,
 *  100's more DHTML scripts, and Terms Of
 *  Use, visit dynamicdrive.com
 *
 *  Updated to support arbitrarily nested lists
 *  by Mark Quinn (mark@robocast.com) November 2nd 1998
 */

var head="display:''"
img1=new Image()
img1.src="img/fold.gif"
img2=new Image()
img2.src="img/open.gif"

function change(){
   if(!document.all)
      return
   if (event.srcElement.id=="foldheader") {
      var srcIndex = event.srcElement.sourceIndex
      var nested = document.all[srcIndex+1]
      if (nested.style.display=="none") {
         nested.style.display=''
         event.srcElement.style.listStyleImage="url(img/open.gif)"
      }
      else {
         nested.style.display="none"
         event.srcElement.style.listStyleImage="url(img/fold.gif)"
      }
   }
}

document.onclick=change

//-->
</script>
            <ul>
              <li id="foldheader">News</li>
              <ul id="foldinglist" style="display:none">
                <li><a href="../../../www.cnn.com/index.html">CNN</a></li>
                <li><a href="../../../www.abcnews.com/index.html">ABC News</a></li>
                <li><a href="../../../www.vancouversun.com/index.html">Vancouver Sun</a></li>
              </ul>
              <li id="foldheader">Games</li>
              <ul id="foldinglist" style="display:none">
                <li><a href="../../../www.gamespot.com/index.html">GameSpot</a></li>
                <li><a href="../../../www.happypuppy.com/index.html">Happy Puppy</a></li>
                <li><a href="../../../www.gamecenter.com/index.html">Game Center</a></li>
              </ul>
              <li id="foldheader">Software</li>
              <ul id="foldinglist" style="display:none">
                <li><a href="../../../www.download.com/index.html">outer 1</a></li>
                <li><a href="../../../www.hotfiles.com/index.html">outer 2</a></li>
                <li id="foldheader">Nested</li>
                <ul id="foldinglist" style="display:none">
                  <li><a href="../../../www.windows95.com/index.html">nested 1</a></li>
                  <li><a href="../../../www.shareware.com/index.html">nested 2</a></li>
                </ul>
                <li><a href="../../../www.windows95.com/index.html">outer 3</a></li>
                <li><a href="../../../www.shareware.com/index.html">outer 4</a></li>
              </ul>
            </ul>
            <script language="JavaScript1.2">
<!--
/**
 * Get cookie routine by Shelley Powers 
 * (shelley.powers@ne-dev.com)
 */
function get_cookie(Name) {
  var search = Name + "="
  var returnvalue = "";
  if (document.cookie.length > 0) {
    offset = document.cookie.indexOf(search)
    // if cookie exists
    if (offset != -1) { 
      offset += search.length
      // set index of beginning of value
      end = document.cookie.indexOf(";", offset);
      // set index of end of cookie value
      if (end == -1) end = document.cookie.length;
      returnvalue=unescape(document.cookie.substring(offset, end))
      }
   }
  return returnvalue;
}

if (get_cookie(window.location.pathname) != ''){
  var openresults=get_cookie(window.location.pathname).split(" ")
  for (i=0 ; i < openresults.length ; i++){
    foldinglist[openresults[i]].style.display=''
    document.all[foldinglist[openresults[i]].sourceIndex -
1].style.listStyleImage="url(img/open.gif)"
  }
}

if (document.all){
  var nodelength=foldinglist.length-1
  var nodes=new Array(nodelength)
  var openones=''
}

function check(){
  for (i=0 ; i <= nodelength ; i++){
    if (foldinglist[i].style.display=='')
       openones=openones + " " + i
  }
  document.cookie=window.location.pathname+"="+openones
}

if (document.all)
  document.body.onunload=check
//-->
</script>
            提示： 点击上面的栏目看看有什么效果？试试刷新页面，发现什么问题？</td>
        </tr>
        <tr> 
          <td>
            <p>1.将下面的代码复制到 &lt;head&gt; 内 
              <input type="button" name="Button" value="复制到我的剪贴板" onClick=JM_cc(js_1)>
              <br>
              <textarea name="js_1" wrap="VIRTUAL" cols="80" rows="10"><style>
<!--
#foldheader{cursor:hand ; font-weight:bold ;
list-style-image:url(fold.gif)}
#foldinglist{list-style-image:url(list.gif)}
//-->
</style>
<script language="JavaScript1.2">
<!--
/** 
 *  Based on Folding Menu Tree 
 *  Dynamic Drive (www.dynamicdrive.com)
 *  For full source code, installation instructions,
 *  100's more DHTML scripts, and Terms Of
 *  Use, visit dynamicdrive.com
 *
 *  Updated to support arbitrarily nested lists
 *  by Mark Quinn (mark@robocast.com) November 2nd 1998
 */

var head="display:''"
img1=new Image()
img1.src="fold.gif"
img2=new Image()
img2.src="open.gif"

function change(){
   if(!document.all)
      return
   if (event.srcElement.id=="foldheader") {
      var srcIndex = event.srcElement.sourceIndex
      var nested = document.all[srcIndex+1]
      if (nested.style.display=="none") {
         nested.style.display=''
         event.srcElement.style.listStyleImage="url(open.gif)"
      }
      else {
         nested.style.display="none"
         event.srcElement.style.listStyleImage="url(fold.gif)"
      }
   }
}

document.onclick=change

//-->
</script></textarea>
              <br>
              <br>
              2.将下面的代码复制到 &lt;body&gt; 内并可修改连接为你的连接 
              <input type="button" name="Button2" value="复制到我的剪贴板" onClick=JM_cc(js_2)>
              <br>
              <textarea name="js_2" wrap="VIRTUAL" cols="80" rows="10"><ul>
   <li id="foldheader">News</li>
   <ul id="foldinglist" style="display:none">
      <li><a href="../../../www.cnn.com/index.html">CNN</a></li>
      <li><a href="../../../www.abcnews.com/index.html">ABC News</a></li>
      <li><a href="../../../www.vancouversun.com/index.html">Vancouver Sun</a></li>
   </ul>

   <li id="foldheader">Games</li>
   <ul id="foldinglist" style="display:none">
      <li><a href="../../../www.gamespot.com/index.html">GameSpot</a></li>
      <li><a href="../../../www.happypuppy.com/index.html">Happy Puppy</a></li>
      <li><a href="../../../www.gamecenter.com/index.html">Game Center</a></li>
   </ul>

   <li id="foldheader">Software</li>
   <ul id="foldinglist" style="display:none">
      <li><a href="../../../www.download.com/index.html">outer 1</a></li>
      <li><a href="../../../www.hotfiles.com/index.html">outer 2</a></li>
      <li id="foldheader">Nested</li>
      <ul id="foldinglist" style="display:none">
         <li><a href="../../../www.windows95.com/index.html">nested 1</a></li>
         <li><a href="../../../www.shareware.com/index.html">nested 2</a></li>
      </ul>
      <li><a href="../../../www.windows95.com/index.html">outer 3</a></li>
      <li><a href="../../../www.shareware.com/index.html">outer 4</a></li>
   </ul>
</ul></textarea>
            </p>
            <p>3.将下面的代码复制到 &lt;body&gt; 内 
              <input type="button" name="Button22" value="复制到我的剪贴板" onClick=JM_cc(js_3)>
              <br>
              <textarea name="js_3" wrap="VIRTUAL" cols="80" rows="10"><script language="JavaScript1.2">
<!--
/**
 * Get cookie routine by Shelley Powers 
 * (shelley.powers@ne-dev.com)
 */
function get_cookie(Name) {
  var search = Name + "="
  var returnvalue = "";
  if (document.cookie.length > 0) {
    offset = document.cookie.indexOf(search)
    // if cookie exists
    if (offset != -1) { 
      offset += search.length
      // set index of beginning of value
      end = document.cookie.indexOf(";", offset);
      // set index of end of cookie value
      if (end == -1) end = document.cookie.length;
      returnvalue=unescape(document.cookie.substring(offset, end))
      }
   }
  return returnvalue;
}

if (get_cookie(window.location.pathname) != ''){
  var openresults=get_cookie(window.location.pathname).split(" ")
  for (i=0 ; i < openresults.length ; i++){
    foldinglist[openresults[i]].style.display=''
    document.all[foldinglist[openresults[i]].sourceIndex -
1].style.listStyleImage="url(open.gif)"
  }
}

if (document.all){
  var nodelength=foldinglist.length-1
  var nodes=new Array(nodelength)
  var openones=''
}

function check(){
  for (i=0 ; i <= nodelength ; i++){
    if (foldinglist[i].style.display=='')
       openones=openones + " " + i
  }
  document.cookie=window.location.pathname+"="+openones
}

if (document.all)
  document.body.onunload=check
//-->
</script>
</textarea>
              <br>
              <br>
              4.注意上面三组代码中你要修改 图片的路径 如 folder.gif open.gif list.gif<br>
              保存图片: <img src="img/fold.gif" width="16" height="16"> 
              <img src="img/open.gif" width="16" height="16"> <img src="img/list.gif" width="16" height="18"></p>
          </td>
        </tr>
      </table>
    </TD>
    <TD><IMG src="../images/space.gif"    width=11 height="1"></TD>
  </TR>
</TABLE>
<!-- #EndEditable -->
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TR bgColor=#ffffff> 
    <TD><IMG src="../images/sq_3.gif" width=11 height="14"></TD>
    <TD width="100%"></TD>
    <TD><IMG src="../images/sq_4.gif"    width=11 height="14"></TD>
  </TR>
</TABLE></BODY><!-- #EndTemplate --></HTML>
