 
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0032)http://www.ie-zone.com/index.php -->
<HTML>
<!-- #BeginTemplate "/Templates/Js.dwt" --> 
<HEAD>
<!-- #BeginEditable "doctitle" --> 
<TITLE>跟随鼠标的双眼</TITLE>
<!-- #EndEditable --> 
<META http-equiv=Content-Type content="text/html; charset=gb2312">
<LINK  href="../../fav.ico" rel="shortcut icon">
<STYLE type=text/css>BODY {
	MARGIN: 25px 25px 25px
}
#all TD {
	FONT-SIZE: 12px; LINE-HEIGHT: 15px; FONT-FAMILY: "Verdana", "Arial","新宋体", "宋体"
}
INPUT {
	FONT-SIZE: 12px; LINE-HEIGHT: 15px; FONT-FAMILY: "Verdana", "Arial","新宋体", "宋体"
}
SELECT {
	FONT-SIZE: 12px; LINE-HEIGHT: 15px; FONT-FAMILY: "Verdana", "Arial","新宋体", "宋体"
}
P {
	FONT-SIZE: 12px; LINE-HEIGHT: 15px; FONT-FAMILY: "Verdana", "Arial","新宋体", "宋体"
}
TEXTAREA {
	FONT-SIZE: 12px; LINE-HEIGHT: 15px; FONT-FAMILY: "Verdana", "Arial","新宋体", "宋体"
}

#all A:active {
	COLOR: #7d070c
}
#all A:visited {
	COLOR: #7d070c
}

#all A:hover {
	COLOR: #336699
}
#all A:link {
	COLOR: #7d070c
}
</STYLE>
<SCRIPT language=JavaScript>
<!--

function MM_goToURL() { //v3.0
  var i, args=MM_goToURL.arguments; document.MM_returnValue = false;
  for (i=0; i<(args.length-1); i+=2) eval(args[i]+".location='"+args[i+1]+"'");
}
function JM_cc(ob){
var obj=MM_findObj(ob); if (obj) { 
obj.select();js=obj.createTextRange();js.execCommand("Copy");}
}

function MM_findObj(n, d) { //v4.0
  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x && document.getElementById) x=document.getElementById(n); return x;
}
//-->
</SCRIPT>
<META content="MSHTML 5.50.4134.600" name=GENERATOR>
</HEAD>
<BODY id=all text=#000000 bgColor=#336699>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TR bgColor=#ffffff> 
    <TD><IMG src="../images/sq_1.gif" width=11 height="14"></TD>
    <TD width="100%"></TD>
    <TD><IMG src="../images/sq_2.gif"    width=11 height="14"></TD>
  </TR>
</TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TR bgColor=#ffffff> 
    <TD><IMG src="../../images/space.gif" width=11 height="1"></TD>
    <TD width="100%"> 
      <table width="100%" border="0" cellpadding="8">
        <tr> 
          <td align="center"> 
            <script language="JavaScript">
document.write("<font color=#7d070c style=\"font-size: 14px\">"+document.title+"</font>");
</script>
          </td>
        </tr>
        <tr> 
          <td bgcolor="#f7f7f7"><!-- #BeginEditable "example" --> 
            <script language="" >
// Watching Eyes Script
// By Virtual_Max  http://www.geocities.com/siliconvalley/lakes/8620
// Modified by Dynamicdrive.com (IE specific bug fixed)
// Permission granted to Dynamicdrive.com to include the script in it's archive
// For 100's more DHTML scripts, visit Dynamicdrive.com
//
// Permission to use, copy, modify, and distribute this software and its documentation 
// for NON-COMMERCIAL purposes and  without fee is hereby granted provided that this 
// notice appears in all copies. 
//
// VIRTUAL MAX MAKES NO REPRESENTATIONS OR WARRANTIES ABOUT THE SUITABILITY OF THE 
// SOFTWARE, EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED 
// WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, OR 
// NON-INFRINGEMENT. VIRTUAL MAX SHALL NOT BE LIABLE FOR ANY DAMAGES SUFFERED BY 
// LICENSEE AS A RESULT OF USING, MODIFYING OR DISTRIBUTING THIS SOFTWARE OR 
// ITS DERIVATIVES.


var brOK=false;
var mie=false;
var ex=0;
var ey=0;
var ae;
var le;
var re;
var x0;
var y0;
var tid;
var realx;
var realy;
var loaded=false;
if(parseInt(navigator.appVersion.charAt(0))>=4)
  {brOK=true;}
if(navigator.appName.indexOf("Microsoft")!=-1)
  {mie=true; }
function myhandler(e)
{ex=e.pageX; 
 ey=e.pageY;
 moveeye()
 return routeEvent(e);
}

function moveeye()
{dy=ey-y0-20;
 dx1=ex-x0-20;
 dx2=ex-x0-60;

 r=Math.sqrt(dx1*dx1+dy*dy);
 if(r<20) r=20
 dx1=dx1*10/r+x0+10;
 dy1=dy*10/r+y0+10;

 r=Math.sqrt(dx2*dx2+dy*dy);
 if(r<20) r=20
 dx2=dx2*10/r+x0+50;

 ae.left=x0;  
 ae.top=y0;  
 le.left=dx1;  
 le.top=dy1;  
 re.left=dx2;  
 re.top=dy1;  
}


function setHandlers()
{if(!mie)   {y0=document.eyeballs.top;
             x0=document.eyeballs.left;
             ae=document.eyeballs;
             le=document.lefteye;   
             re=document.righteye;   
             window.captureEvents(Event.MOUSEMOVE);
             window.onMouseMove=myhandler;
            }
 else       {y0=document.all.eyeballs.style.pixelTop;
             x0=document.all.eyeballs.style.pixelLeft;
             ae=document.all.eyeballs.style;
             le=document.all.lefteye.style;
             re=document.all.righteye.style;
            }
 realx=x0+0.1;
 realy=y0+0.1;
 
 moveall();
 loaded=true;
}

function moveall()
{rx=realx+40
 ry=realy+40;
 rx+=(ex-rx)*0.1;
 ry+=(ey-ry)*0.1;
 realx=rx-40;
 realy=ry-40;
 x0=Math.round(realx);
 y0=Math.round(realy);
 moveeye();
 tid=setTimeout('moveall()',100);
}

function placeeyes(x,y)
{if(brOK)
 {ex=x+40;
  ey=y+40;
  s ='<DIV ID="dummy"    STYLE="position:absolute; top:'+y+'; left:'+x+'; width:10; height:10;">&nbsp;</DIV>';
  s+='<DIV ID="eyeballs" STYLE="position:absolute; top:'+y+'; left:'+x+'; width:80; height:40;"  ><IMG SRC="img/eyeballs.gif"  border=0></DIV>';
  s+='<DIV ID="lefteye"  STYLE="position:absolute; top:'+(y+10)+'; left:'+(x+10)+'; width:20; height:20;"  ><IMG SRC="img/eye.gif"       border=0></DIV>';
  s+='<DIV ID="righteye" STYLE="position:absolute; top:'+(y+10)+'; left:'+(x+50)+'; width:20; height:20;"  ><IMG SRC="img/eye.gif"       border=0></DIV>';
  document.writeln(s);
 }
}
</script>
            <script for=document event="onmousemove()">
if((mie==true)&&(brOK)&&loaded)
  {ex=document.body.scrollLeft+event.x;
   ey=document.body.scrollTop+event.y;
   moveeye();
  }
</script>
            <script>
if (document.all||document.layers)
 placeeyes(200,100);
</script>
            <script language="JavaScript">
function gogo(){
if (brOK) setHandlers()
}
window.onload=gogo
function gogogo(){
if(brOK) {if(tid) clearTimeout(tid);}
}
window.onUnload=gogogo

</script>
            提示:看到两个大眼睛吗？ <!-- #EndEditable --></td>
        </tr>
        <tr> 
          <td><!-- #BeginEditable "code" -->1.将下面的代码复制到 &lt;body&gt; 内 
            <input type="button" name="Button" value="复制到我的剪贴板" onClick=JM_cc('js_1')>
            <br>
            <form name="form1" method="post" action="">
              <textarea name="js_1" wrap="VIRTUAL" cols="80" rows="10"><SCRIPT >
// Watching Eyes Script
// By Virtual_Max  http://www.geocities.com/siliconvalley/lakes/8620
// Modified by Dynamicdrive.com (IE specific bug fixed)
// Permission granted to Dynamicdrive.com to include the script in it's archive
// For 100's more DHTML scripts, visit Dynamicdrive.com
//
// Permission to use, copy, modify, and distribute this software and its documentation 
// for NON-COMMERCIAL purposes and  without fee is hereby granted provided that this 
// notice appears in all copies. 
//
// VIRTUAL MAX MAKES NO REPRESENTATIONS OR WARRANTIES ABOUT THE SUITABILITY OF THE 
// SOFTWARE, EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED 
// WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, OR 
// NON-INFRINGEMENT. VIRTUAL MAX SHALL NOT BE LIABLE FOR ANY DAMAGES SUFFERED BY 
// LICENSEE AS A RESULT OF USING, MODIFYING OR DISTRIBUTING THIS SOFTWARE OR 
// ITS DERIVATIVES.


var brOK=false;
var mie=false;
var ex=0;
var ey=0;
var ae;
var le;
var re;
var x0;
var y0;
var tid;
var realx;
var realy;
var loaded=false;
if(parseInt(navigator.appVersion.charAt(0))>=4)
  {brOK=true;}
if(navigator.appName.indexOf("Microsoft")!=-1)
  {mie=true; }
function myhandler(e)
{ex=e.pageX; 
 ey=e.pageY;
 moveeye()
 return routeEvent(e);
}

function moveeye()
{dy=ey-y0-20;
 dx1=ex-x0-20;
 dx2=ex-x0-60;

 r=Math.sqrt(dx1*dx1+dy*dy);
 if(r<20) r=20
 dx1=dx1*10/r+x0+10;
 dy1=dy*10/r+y0+10;

 r=Math.sqrt(dx2*dx2+dy*dy);
 if(r<20) r=20
 dx2=dx2*10/r+x0+50;

 ae.left=x0;  
 ae.top=y0;  
 le.left=dx1;  
 le.top=dy1;  
 re.left=dx2;  
 re.top=dy1;  
}


function setHandlers()
{if(!mie)   {y0=document.eyeballs.top;
             x0=document.eyeballs.left;
             ae=document.eyeballs;
             le=document.lefteye;   
             re=document.righteye;   
             window.captureEvents(Event.MOUSEMOVE);
             window.onMouseMove=myhandler;
            }
 else       {y0=document.all.eyeballs.style.pixelTop;
             x0=document.all.eyeballs.style.pixelLeft;
             ae=document.all.eyeballs.style;
             le=document.all.lefteye.style;
             re=document.all.righteye.style;
            }
 realx=x0+0.1;
 realy=y0+0.1;
 
 moveall();
 loaded=true;
}

function moveall()
{rx=realx+40
 ry=realy+40;
 rx+=(ex-rx)*0.1;
 ry+=(ey-ry)*0.1;
 realx=rx-40;
 realy=ry-40;
 x0=Math.round(realx);
 y0=Math.round(realy);
 moveeye();
 tid=setTimeout('moveall()',100);
}

function placeeyes(x,y)
{if(brOK)
 {ex=x+40;
  ey=y+40;
  s ='<DIV ID="dummy"    STYLE="position:absolute; top:'+y+'; left:'+x+'; width:10; height:10;">&nbsp;</DIV>';
  s+='<DIV ID="eyeballs" STYLE="position:absolute; top:'+y+'; left:'+x+'; width:80; height:40;"  ><IMG SRC="eyeballs.gif"  border=0></DIV>';
  s+='<DIV ID="lefteye"  STYLE="position:absolute; top:'+(y+10)+'; left:'+(x+10)+'; width:20; height:20;"  ><IMG SRC="eye.gif"       border=0></DIV>';
  s+='<DIV ID="righteye" STYLE="position:absolute; top:'+(y+10)+'; left:'+(x+50)+'; width:20; height:20;"  ><IMG SRC="eye.gif"       border=0></DIV>';
  document.writeln(s);
 }
}
</script>
<script FOR=document Event="onmousemove()">
if((mie==true)&&(brOK)&&loaded)
  {ex=document.body.scrollLeft+event.x;
   ey=document.body.scrollTop+event.y;
   moveeye();
  }
</script>

<script>
if (document.all||document.layers)
 placeeyes(200,100);
</script></textarea>
            </form>
            <br>
            2使用到的两张图片<br>
            <img src="img/eyeballs.gif" width="80" height="40" border="1"> 
            <img src="img/eye.gif" width="20" height="20"> <br>
            <br>
            3在&lt;body&gt;中加入<br>
            &lt;body onLoad=&quot;if(brOK) setHandlers()&quot; onUnload=&quot;if(brOK) 
            {if(tid) clearTimeout(tid);}&quot;&gt;
            <p></p>
            <!-- #EndEditable --></td>
        </tr>
      </table>
    </TD>
    <TD><IMG src="../../images/space.gif"    width=11 height="1"></TD>
  </TR>
</TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TR bgColor=#ffffff> 
    <TD><IMG src="../images/sq_3.gif" width=11 height="14"></TD>
    <TD width="100%"></TD>
    <TD><IMG src="../images/sq_4.gif"    width=11 height="14"></TD>
  </TR>
</TABLE>
</BODY>
<!-- #EndTemplate -->
</HTML>
