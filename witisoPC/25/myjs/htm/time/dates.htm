<form>
<select id=year onchange=toDate()>
<script>for(i=1970;i<=2010;i++)document.write("<option>"+i+"</option>")</script>
</select>
<select id=month onchange=toDate()>
<script>for(i=1;i<=12;i++)document.write("<option>"+i+"</option>")</script>
</select>
<select id=day onchange=toDay()></select>
<input name=weekday>
</form>
<script>
var arr="日一二三四五六".split("")

function toDate(){
	with(document.all){
		vYear=parseInt(year.options[year.selectedIndex].text)
		vMonth=parseInt(month.options[month.selectedIndex].text)
		day.length=0;
		for(i=0;i<(new Date(vYear,vMonth,0)).getDate();i++){day.options[day.length++].value=day.length;day.options[day.length-1].text=day.length;}
	}
	toDay();
}

function toDay(){
	vDay=parseInt(document.all.day.options[document.all.day.selectedIndex].value)
	document.all("weekday").value="星期"+arr[new Date(vYear,vMonth-1,vDay).getDay()]
}

window.onload=toDate;
</script>
