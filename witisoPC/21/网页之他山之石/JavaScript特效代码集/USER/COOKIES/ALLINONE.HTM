<html>
<head>
<title>cookies </title>
</head>
<BODY onLoad="startclock()" background="../../../images/bg011.gif">
<center>
  <form>
    <div align="center"> <font size="3">集成Cookies、浏览器检测、问候和访问时间于一体的脚本 </font></div>
  </form>
  <script language="JavaScript">





<!-- Beginning of JavaScript Applet -------------------



var username = GetCookie('username');





if (username == null) {







  username = prompt('Enter Your Name:',"Web Surfer");







  if (username == null) {







    alert('Its ok if you dont want to tell us your name');



    username = 'WebSurfer';







  } else {







    // don't set the username cookie.... because the user refused to tell you.



    // they will be prompted next time....







    pathname = location.pathname;



    myDomain = pathname.substring(0,pathname.lastIndexOf('/')) +'/';







    // set expiry date to 1 year from now.



    var largeExpDate = new Date ();



    largeExpDate.setTime(largeExpDate.getTime() + (30 * 24 * 3600 * 1000));







    SetCookie('username',username,largeExpDate,myDomain);



  }







}





function getCookieVal (offset) {



   var endstr = document.cookie.indexOf (";", offset);



   if (endstr == -1)



      endstr = document.cookie.length;



   return unescape(document.cookie.substring(offset, endstr));



}



function GetCookie (name) {



        var arg = name + "=";



        var alen = arg.length;



        var clen = document.cookie.length;



        var i = 0;



        while (i < clen) {



                var j = i + alen;



                if (document.cookie.substring(i, j) == arg)



                        return getCookieVal (j);



                i = document.cookie.indexOf(" ", i) + 1;



                        if (i == 0)



                                break;



                }



   return null;



}



function SetCookie (name, value) {



        var argv = SetCookie.arguments;



        var argc = SetCookie.arguments.length;



        var expires = (argc > 2) ? argv[2] : null;



        var path = (argc > 3) ? argv[3] : null;



        var domain = (argc > 4) ? argv[4] : null;



        var secure = (argc > 5) ? argv[5] : false;



        document.cookie = name + "=" + escape (value) +



                ((expires == null) ? "" : ("; expires=" +



expires.toGMTString())) +



                ((path == null) ? "" : ("; path=" + path)) +



                ((domain == null) ? "" : ("; domain=" + domain)) +



                ((secure == true) ? "; secure" : "");



}







  // -- End of JavaScript code -------------- -->







</script>
  <script

language="JavaScript">

<!-- 
function getCookieVal (offset) 

   {

   var endstr = document.cookie.indexOf (";", offset);

   if (endstr == -1)

      endstr = document.cookie.length;

   return unescape(document.cookie.substring(offset, endstr));

   }

function GetCookie (name) 

   {

   var arg = name + "=";

   var alen = arg.length;

   var clen = document.cookie.length;

   var i = 0;

   while (i < clen) 

      {

      var j = i + alen;

      if (document.cookie.substring(i, j) == arg)

         return getCookieVal (j);

      i = document.cookie.indexOf(" ", i) + 1;

      if (i == 0) 

         break; 

      }

   return null;

   }

function SetCookie (name, value) 

   {

   var argv = SetCookie.arguments;

   var argc = SetCookie.arguments.length;

   var expires = (2 < argc) ? argv[2] : null;

   var path = (3 < argc) ? argv[3] : null;

   var domain = (4 < argc) ? argv[4] : null;

   var secure = (5 < argc) ? argv[5] : false;

   document.cookie = name + "=" + escape (value) +

     ((expires == null) ? "" : ("; expires=" + expires.toGMTString())) +

     ((path == null) ? "" : ("; path=" + path)) +

     ((domain == null) ? "" : ("; domain=" + domain)) +

	((secure == true) ? "; secure" : "");

   }

function ResetCounts(name) 

   {

   visits = 0;

   SetCookie("visits", visits, expdate , "/", null, false);

   location.reload();

   }

// -- End Hiding Here -->

</script>

<h2 align="center"><b><i>
<script language="JavaScript">

<!-- 
var expdate = new Date();

var visits;

// Set expiration date to a year from now.

expdate.setTime(expdate.getTime() +  (24 * 60 * 60 * 1000 * 365)); 

if(!(visits = GetCookie("visits"))) 

   visits = 0;

visits++;

SetCookie("visits", visits, expdate, "/", null, false);

   if(visits == 1) 

      document.write('<P><CENTER>Welcome Cadet '+username+'</CENTER>');

   if(visits == 2) 

      document.write('<P><CENTER>Welcome Ensign '+username+'</CENTER>');

   if(visits == 3) 

      document.write('<P><CENTER>Welcome Lieutenant '+username+'</CENTER>');

   if(visits == 4) 

      document.write('<P><CENTER>Welcome Lieutenant-Commander '+username+'</CENTER>');

   if(visits == 5) 

      document.write('<P><CENTER>Welcome Commander '+username+'</CENTER>');

   if(visits == 6) 

      document.write('<P><CENTER>Welcome Vice-Admiral '+username+'</CENTER>');

   if(visits == 7) 

      document.write('<P><CENTER>Welcome Admiral '+username+'</CENTER>');

   if(visits== 8) 

      document.write('<P><CENTER>Welcome Demi-God '+username+'</CENTER>');

   if(visits== 9) 

      document.write('<P><CENTER>Welcome Demi-God '+username+'</CENTER>');

   if(visits>=10) 

      document.write('<P><CENTER>Welcome Master '+username+'</CENTER>');

// -- End Hiding Here -->

</script>
</i></b></h2>

<br>

<FONT FACE=ARIAL size="2">

<b>Your access was granted from
<SCRIPT language="javascript">document.write(document.referrer)</SCRIPT><br>
Using <SCRIPT language="javascript">document.write(navigator.userAgent)</SCRIPT>
</b></font>


<br>
<p>
</p>
<SCRIPT LANGUAGE="Javascript">
<!-- Activate Cloaking 
//
// JavaScript to calculate visits using cookies.
//
// Public Domain Cookie Functions 
//



function getCookieVal (offset) 

   {

   var endstr = document.cookie.indexOf (";", offset);

   if (endstr == -1)

      endstr = document.cookie.length;

   return unescape(document.cookie.substring(offset, endstr));

   }



function GetCookie (name) 

   {

   var arg = name + "=";

   var alen = arg.length;

   var clen = document.cookie.length;

   var i = 0;

   while (i < clen) 

      {

      var j = i + alen;

      if (document.cookie.substring(i, j) == arg)

         return getCookieVal (j);

      i = document.cookie.indexOf(" ", i) + 1;

      if (i == 0) 

         break; 

      }

   return null;

   }



function SetCookie (name, value) 

   {

   var argv = SetCookie.arguments;

   var argc = SetCookie.arguments.length;

   var expires = (2 < argc) ? argv[2] : null;

   var path = (3 < argc) ? argv[3] : null;

   var domain = (4 < argc) ? argv[4] : null;

   var secure = (5 < argc) ? argv[5] : false;

   document.cookie = name + "=" + escape (value) +

     ((expires == null) ? "" : ("; expires=" + expires.toGMTString())) +

     ((path == null) ? "" : ("; path=" + path)) +

     ((domain == null) ? "" : ("; domain=" + domain)) +

	((secure == true) ? "; secure" : "");

   }



//  Function to reset counts

function ResetCounts(name) 

   {

   visits = 0;

   SetCookie("visits", visits, expdate , "/", null, false);

   leapto();

   }

// De-activate Cloaking -->

</SCRIPT>
<FONT FACE=ARIAL SIZE=2>
<SCRIPT LANGUAGE="Javascript">
<!-- Activate Cloaking 

var expdate = new Date();

var visits;

expdate.setTime(expdate.getTime() +  (24 * 60 * 60 * 1000 * 365)); 

if(!(visits = GetCookie("visits"))) 

   visits = 0;

visits++;

SetCookie("visits", visits, expdate, "/", null, false);

document.write(""+"You Have Visited This Page "+visits+" time(s).");
//-->
</SCRIPT>
</font>
<br>
You arrived at
<script language="JavaScript">
<!-- Hide this script from old browsers --
	Stamp = new Date();
	var Hours;
	var Mins;
	var Time;
	Hours = Stamp.getHours();
	if (Hours >= 12) {
	        Time = " P.M.";
	}
        else {
                Time = " A.M.";
        }
	
	if (Hours > 12) {
        	Hours -= 12;
        }
	if (Hours == 0) {
        	Hours = 12;
        }
	Mins = Stamp.getMinutes();
	if (Mins < 10) {
        	Mins = "0" + Mins;
        }
	
	document.write('<font size="2" face="Arial"><B>' + Hours + ":" + Mins + Time + '</B></font>');
// -- End Hiding Here -->
</script>
<br>
The current time is:<br>
<script Language="JavaScript">

<!-- Helpers ...
// Navigation - Start
function goback(){
alert("Good Bye!");
history.go(-1);
}
function gettheDate() {
Todays = new Date();
TheDate = "" + (Todays.getMonth()+ 1) +" / "+ Todays.getDate() + " / " + 
Todays.getYear() 
document.clock.date.value = TheDate;
}
// Navigation - Stop
// Netscapes Clock - Start
// this code was taken from Netscapes JavaScript documentation at
// www.netscape.com on Jan.25.96

var timerID = null;
var timerRunning = false;
function stopclock (){
        if(timerRunning)
                clearTimeout(timerID);
        timerRunning = false;
}

function startclock () {
        // Make sure the clock is stopped
        stopclock();
        gettheDate()
        showtime();
}

function showtime () {
        var now = new Date();
        var hours = now.getHours();
        var minutes = now.getMinutes();
        var seconds = now.getSeconds()
        var timeValue = "" + ((hours >12) ? hours -12 :hours)
        timeValue += ((minutes < 10) ? ":0" : ":") + minutes
        timeValue += ((seconds < 10) ? ":0" : ":") + seconds
        timeValue += (hours >= 12) ? " P.M." : " A.M."
        document.clock.face.value = timeValue;
        // you could replace the above with this
        // and have a clock on the status bar:
        // window.status = timeValue;
        timerID = setTimeout("showtime()",1000);
        timerRunning = true;
}
// Netscapes Clock - Stop

// end Helpers -->

</script>

<table>
<tr>
<td colspan=3>
<form name="clock" onSubmit="0">
<div align=left>
<b><font size="-1"></font></b>
<input type="text" name="date" size=12 value="">
<input type="text" name="face" size=12 value="">
</div>
</form>
</table>


当然你没必要将所有的功能放在页面上，这里仅仅提供了一些脚本的源码，请合理取舍。<br>
  Cookies记录了访问的次数，根据访问次数的多少，对于访问者的问候是不同的，你可以<br>
  修改源码让它每次的问候都相同，这样减少了代码的长度。 
</center>
</body>
</html>		


