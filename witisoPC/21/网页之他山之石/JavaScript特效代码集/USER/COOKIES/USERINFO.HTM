<HTML> 
<TITLE>All in one cookie</TITLE>
<style type="text/css">
<!--
.unnamed1 {  font-family: "宋体"; font-size: 9pt; text-decoration: none}
td { font-family: "宋体"; font-size: 9pt; text-decoration: none }
-->
</style></head>
<BODY background="../../../images/bg011.gif">
<form>
  <div align="center"> <font size="5" color="#FF0000">Cookies之来将通名</font> </div>
</form>
<table width="75%" border="0" align="center">
  <tr bgcolor="bisque"> 
    <td> 
      <script language="JavaScript">

<!-- Hide this script from old browsers --
var expDays = 365;
var exp = new Date(); 
exp.setTime(exp.getTime() + (expDays*24*60*60*1000));
function Who(info){
                var VisitorName = GetCookie('VisitorName')
                if (VisitorName == null) {
                        VisitorName = prompt("来将通名！",'');
                        SetCookie ('VisitorName', VisitorName, exp);
                }
        return VisitorName;
}
function When(info){
                var rightNow = new Date()
                var WWHTime = 0;
                WWHTime = GetCookie('WWhenH')
                
                WWHTime = WWHTime * 1
                var lastHereFormatting = new Date(WWHTime);  // Date-i-fy that number
                var intLastVisit = (lastHereFormatting.getYear() * 10000)+(lastHereFormatting.getMonth() * 100) + lastHereFormatting.getDate()
                var lastHereInDateFormat = "" + lastHereFormatting;  // Gotta use substring functions
                var dayOfWeek = lastHereInDateFormat.substring(0,3)
                var dateMonth = lastHereInDateFormat.substring(4,10)
                var timeOfDay = lastHereInDateFormat.substring(11,16)
                var year = lastHereInDateFormat.substring(23,25)
                var WWHText = dayOfWeek + ", " + dateMonth // display               
         SetCookie ("WWhenH", rightNow.getTime(), exp)
        return WWHText;
}
function Count(info){
                var WWHCount = GetCookie('WWHCount')
                if (WWHCount == null) {
                        WWHCount = 0;
                }
                else{
                        WWHCount++;
                }
                SetCookie ('WWHCount', WWHCount, exp);
        return WWHCount;
}
function set(){
        VisitorName = prompt("来将通名！",'');
        SetCookie ('VisitorName', VisitorName, exp);
        SetCookie ('WWHCount', 0, exp);
        SetCookie ('WWhenH', 0, exp);
}
function getCookieVal (offset) {  
        var endstr = document.cookie.indexOf (";", offset);  
        if (endstr == -1)    
                endstr = document.cookie.length;  
                return unescape(document.cookie.substring(offset, endstr));
}
function GetCookie (name) {  
        var arg = name + "=";  
        var alen = arg.length;  
        var clen = document.cookie.length;  
        var i = 0;  
        while (i < clen) {    
        var j = i + alen;    
        if (document.cookie.substring(i, j) == arg)      
                return getCookieVal (j);    
                i = document.cookie.indexOf(" ", i) + 1;    
                if (i == 0) break;   
        }  
        return null;
}
function SetCookie (name, value) {  
        var argv = SetCookie.arguments;  
        var argc = SetCookie.arguments.length;  
        var expires = (argc > 2) ? argv[2] : null;  
        var path = (argc > 3) ? argv[3] : null;  
        var domain = (argc > 4) ? argv[4] : null;  
        var secure = (argc > 5) ? argv[5] : false;  
        document.cookie = name + "=" + escape (value) + 
        ((expires == null) ? "" : ("; expires=" + expires.toGMTString())) + 
        ((path == null) ? "" : ("; path=" + path)) +  
        ((domain == null) ? "" : ("; domain=" + domain)) +    
        ((secure == true) ? "; secure" : "");
}
function DeleteCookie (name) {  
        var exp = new Date();  
        exp.setTime (exp.getTime() - 1);  
        // This cookie is history  
        var cval = GetCookie (name);  
        document.cookie = name + "=" + cval + "; expires=" + exp.toGMTString();
}
// -- End Hiding Here -->

</script>
      <script language="JavaScript">

<!-- Hide this script from old browsers --
document.write("你好！" + Who() + "你来此" + Count() + "次了。最近一次是" + When() +"。")
document.write('<a href="JavaScript:set()">换个名字</a>')
// -- End Hiding Here -->

</script>
    </td>
  </tr>
  <tr>
    <td>&lt;script language=&quot;JavaScript&quot;&gt;
      <p>&lt;!-- Hide this script from old browsers --<br>
        var expDays = <font color="#FF0000">365</font>; //设置cookies时间，任意设。<br>
        var exp = new Date(); <br>
        exp.setTime(exp.getTime() + (expDays*24*60*60*1000));<br>
        function Who(info){<br>
        var VisitorName = GetCookie('VisitorName')<br>
        if (VisitorName == null) {<br>
        VisitorName = prompt(&quot;来将通名！&quot;,'');<br>
        SetCookie ('VisitorName', VisitorName, exp);<br>
        }<br>
        return VisitorName;<br>
        }<br>
        function When(info){<br>
        var rightNow = new Date()<br>
        var WWHTime = 0;<br>
        WWHTime = GetCookie('WWhenH')<br>
        <br>
        WWHTime = WWHTime * 1<br>
        var lastHereFormatting = new Date(WWHTime); // Date-i-fy that number<br>
        var intLastVisit = (lastHereFormatting.getYear() * 10000)+(lastHereFormatting.getMonth() 
        * 100) + lastHereFormatting.getDate()<br>
        var lastHereInDateFormat = &quot;&quot; + lastHereFormatting; // Gotta 
        use substring functions<br>
        var dayOfWeek = lastHereInDateFormat.substring(0,3)<br>
        var dateMonth = lastHereInDateFormat.substring(4,10)<br>
        var timeOfDay = lastHereInDateFormat.substring(11,16)<br>
        var year = lastHereInDateFormat.substring(23,25)<br>
        var WWHText = dayOfWeek + &quot;, &quot; + dateMonth <br>
        SetCookie (&quot;WWhenH&quot;, rightNow.getTime(), exp)<br>
        return WWHText;<br>
        }<br>
        function Count(info){<br>
        var WWHCount = GetCookie('WWHCount')<br>
        if (WWHCount == null) {<br>
        WWHCount = 0;<br>
        }<br>
        else{<br>
        WWHCount++;<br>
        }<br>
        SetCookie ('WWHCount', WWHCount, exp);<br>
        return WWHCount;<br>
        }<br>
        function set(){<br>
        VisitorName = prompt(&quot;来将通名！&quot;,'');<br>
        SetCookie ('VisitorName', VisitorName, exp);<br>
        SetCookie ('WWHCount', 0, exp);<br>
        SetCookie ('WWhenH', 0, exp);<br>
        }<br>
        function getCookieVal (offset) { <br>
        var endstr = document.cookie.indexOf (&quot;;&quot;, offset); <br>
        if (endstr == -1) <br>
        endstr = document.cookie.length; <br>
        return unescape(document.cookie.substring(offset, endstr));<br>
        }<br>
        function GetCookie (name) { <br>
        var arg = name + &quot;=&quot;; <br>
        var alen = arg.length; <br>
        var clen = document.cookie.length; <br>
        var i = 0; <br>
        while (i &lt; clen) { <br>
        var j = i + alen; <br>
        if (document.cookie.substring(i, j) == arg) <br>
        return getCookieVal (j); <br>
        i = document.cookie.indexOf(&quot; &quot;, i) + 1; <br>
        if (i == 0) break; <br>
        } <br>
        return null;<br>
        }<br>
        function SetCookie (name, value) { <br>
        var argv = SetCookie.arguments; <br>
        var argc = SetCookie.arguments.length; <br>
        var expires = (argc &gt; 2) ? argv[2] : null; <br>
        var path = (argc &gt; 3) ? argv[3] : null; <br>
        var domain = (argc &gt; 4) ? argv[4] : null; <br>
        var secure = (argc &gt; 5) ? argv[5] : false; <br>
        document.cookie = name + &quot;=&quot; + escape (value) + <br>
        ((expires == null) ? &quot;&quot; : (&quot;; expires=&quot; + expires.toGMTString())) 
        + <br>
        ((path == null) ? &quot;&quot; : (&quot;; path=&quot; + path)) + <br>
        ((domain == null) ? &quot;&quot; : (&quot;; domain=&quot; + domain)) + 
        <br>
        ((secure == true) ? &quot;; secure&quot; : &quot;&quot;);<br>
        }<br>
        function DeleteCookie (name) { <br>
        var exp = new Date(); <br>
        exp.setTime (exp.getTime() - 1); <br>
        // This cookie is history <br>
        var cval = GetCookie (name); <br>
        document.cookie = name + &quot;=&quot; + cval + &quot;; expires=&quot; 
        + exp.toGMTString();<br>
        }<br>
        // -- End Hiding Here --&gt;</p>
      <p>&lt;/script&gt;</p>
      <p>&lt;script language=&quot;JavaScript&quot;&gt;</p>
      <p>&lt;!-- Hide this script from old browsers --<br>
        document.write(&quot;你好！&quot; + Who() + &quot;你来此&quot; + Count() + &quot;次了。最近一次是&quot; 
        + When() +&quot;。&quot;)<br>
        document.write('&lt;a href=&quot;JavaScript:set()&quot;&gt;换个名字&lt;/a&gt;')<br>
        // -- End Hiding Here --&gt;</p>
      <p>&lt;/script&gt;</p>
    </td>
  </tr>
</table>
<p>&nbsp;</p>
</body>
</html> 
