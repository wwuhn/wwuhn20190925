<HTML>
<HEAD>
<TITLE>状态栏跑马灯</TITLE>
<SCRIPT LANGUAGE="JavaScript">

<!--
var txt_msg = new Array();

txt_msg[0] = "将本站告诉你的朋友！好东西就要大家分享。";

txt_msg[1] = "订阅本站的免费邮件列表-JAVA脚本送上门！";

txt_msg[2] = "感谢光临JAVA2000！";

txt_msg[3] = "将本站加入您的收藏夹吧！";

var q_msg = 3;

var msg_num = 0;

var msg_len = 0;

var msg_scr = 0;

var reset_val = 0;

//改变下面的时间参数，使跑马灯工作得更好。

t_type = 90; 

t_disp = 1500;

t_scr = 30;

t_blank = 750;

//如下函数产生跑马灯效果，当所有信息显示完毕时，便呼叫'removes()'循环显示。

function displays() {

	if (msg_num > q_msg) {

		msg_num = reset_val;

	}

msg_len++;

window.status = txt_msg[msg_num].substring(reset_val, msg_len);

	if (msg_len == txt_msg[msg_num].length) {

//信息显示完后的时间间隔

		timer_disp=window.setTimeout ("removes()", t_disp);

	}         

	else {

//递归呼叫函数显示下一个字符。

		timer_type=window.setTimeout ("displays()", t_type);

	}

}


//使一个字符从左侧产生移动，产生跑马灯效果，当移动结束'displays()'再次被呼叫。

function removes()

{

msg_scr++;

	if (msg_scr > txt_msg[msg_num].length) {

		msg_num++;    

		msg_len = reset_val;

		msg_scr = reset_val;

//	This timer is executed after the message is completely removed.

		timer_blank=window.setTimeout ("displays()", t_blank)

	}

	else {

		window.status = txt_msg[msg_num].substring(msg_scr, txt_msg[msg_num].length);

//	This timer calls this function recursively to remove letters.  This gives the appearance of scrolling.  

		timer_scr=window.setTimeout ("removes()", t_scr);

	}
 
}

//-->

</SCRIPT>

<style type="text/css">
<!--
.unnamed1 {  font-family: "宋体"; font-size: 9pt; text-decoration: none}
-->
</style></HEAD>

<BODY onload=displays()>
<div align="center"></div>
<form>
  <div align="center"> <font size="5" color="#FF0000">状态栏跑马灯</font></div>
</form>
<p align="center"> 
  <textarea name="textfield" rows="10" cols="65" class="unnamed1">如下代码加入&lt;HEAD&gt;区：
&lt;SCRIPT LANGUAGE=&quot;JavaScript&quot;&gt;
&lt;!--
var txt_msg = new Array();

txt_msg[0] = &quot;状态栏内容1&quot;;

txt_msg[1] = &quot;状态栏内容2&quot;;

txt_msg[2] = &quot;状态栏内容3&quot;;

//随便增加信息的显示数目，记得相应地要增加下面一行的数目才行。

var q_msg = 2;

var msg_num = 0;

var msg_len = 0;

var msg_scr = 0;

var reset_val = 0;

//改变下面的时间参数，使跑马灯工作得更好。

t_type = 90; 

t_disp = 1500;

t_scr = 30;

t_blank = 750;

function displays() {

	if (msg_num &gt; q_msg) {

		msg_num = reset_val;

	}

msg_len++;

window.status = txt_msg[msg_num].substring(reset_val, msg_len);

	if (msg_len == txt_msg[msg_num].length) {

        timer_disp=window.setTimeout (&quot;removes()&quot;, t_disp);

	}         

	else {

	timer_type=window.setTimeout (&quot;displays()&quot;, t_type);

	}

}

function removes()

{

msg_scr++;

	if (msg_scr &gt; txt_msg[msg_num].length) {

		msg_num++;    

		msg_len = reset_val;

		msg_scr = reset_val;

		timer_blank=window.setTimeout (&quot;displays()&quot;, t_blank)

	}

	else {

		window.status = txt_msg[msg_num].substring(msg_scr, txt_msg[msg_num].length);

          	timer_scr=window.setTimeout (&quot;removes()&quot;, t_scr);

	}
 
}

//--&gt;

&lt;/SCRIPT&gt;
最后，用下面一行替换原有的&lt;BODY&gt;:
&lt;BODY onload=displays()&gt;</textarea>
</p>
</BODY>

</HTML>

